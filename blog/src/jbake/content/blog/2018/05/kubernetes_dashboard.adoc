= Kubernetes: Enable dashboard
@marioggar
2018-05-05
:jbake-type: post
:jbake-status: draft
:jbake-tags: kubernetes, devops
:idprefix:

== Intro

The Kubernetes dashboard could be a very useful tool when checking
what is going on in your Kubernetes infrastructure. The problem is
that there's a lot of misunderstandings around its installation and
use. That was the main reason why I'm creating this entry.

== Installing POD

NOTE: This part is based on
https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/

NOTE: Stackoverflow How to sign in Kubernetes Dashboard
https://stackoverflow.com/questions/46664104/how-to-sign-in-kubernetes-dashboard

NOTE: This part is based on
https://github.com/kubernetes/dashboard/wiki/Access-control

NOTE: Create sample user
https://github.com/kubernetes/dashboard/wiki/Creating-sample-user

[source, shell]
----
kubectl create -f https://raw.githubusercontent.com/kubernetes/dashboard/master/src/deploy/recommended/kubernetes-dashboard.yaml
----

== Accessing the dashboard

[source, shell]
----
kubectl proxy --address 192.168.33.10 --port=2087 --accept-hosts='^*$'
----

[source, shell]
----
cat <<EOF | kubectl create -f -
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: kubernetes-dashboard
  labels:
    k8s-app: kubernetes-dashboard
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: kubernetes-dashboard
  namespace: kube-system
EOF
----

Then you can access the dashboard at http://192.168.33.10:2087/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy


== References

- https://github.com/kubernetes/dashboard/issues/2404[Dashboard not working with https]
- https://github.com/kubernetes/dashboard/issues/692[Response unauthorized]
- https://kubernetes.io/docs/admin/authentication/#users-in-kubernetes
- https://github.com/kubernetes/dashboard/wiki/Access-control