<!DOCTYPE html><html lang="en">
    <head>
<meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0 user-scalable=no"/>
        <title>Working in Progress</title>
        <link rel="stylesheet" href="/css/main.css"/>
        <link rel="stylesheet" href="/css/zenburn.css"/>
        
        
    </head><body class="is-preload">
        <div id="wrapper">
            <div id="main">
                <div class="inner">
                    <header id="header">
                        <a href="/index.html" class="logo">
                            <strong>
                                WORKING IN PROGRESS
                            </strong> - POST
                        </a><ul class="icons">
                            <li>
                                <a href="/feed.xml" class="icon fa-rss">
                                    <span class="label">
                                        Twitter
                                    </span>
                                </a>
                            </li><li>
                                <a href="https://twitter.com/marioggar" class="icon fa-twitter">
                                    <span class="label">
                                        Twitter
                                    </span>
                                </a>
                            </li><li>
                                <a href="https://github.com/mariogarcia" class="icon fa-github">
                                    <span class="label">
                                        Github
                                    </span>
                                </a>
                            </li>
                        </ul>
                    </header><section><header class="main"><div class="metadata"><em class="fa fa-calendar-o"></em><b>2016-03-29</b></div><h1>Frege basics: File I/O</h1></header><yieldScaped><div class="sect2">
<h3 id="intro">Intro</h3>
<div class="paragraph">
<p>All examples are based on <code>IO.fr</code> module functions. You can find them
<a href="https://github.com/Frege/frege/blob/master/frege/java/IO.fr">Here</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="reading">Reading</h3>
<div class="paragraph">
<p>We&#8217;ll be using the <strong>openReader</strong> function. It creates a
<strong>BufferedReader</strong> from a given file path in the form of a <strong>String</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-haskell" data-lang="haskell">openReader :: String -&gt; IO BufferedReader</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first example reads a file getting a list of lines out of it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-haskell" data-lang="haskell">readLines :: String -&gt; IO [String]
readLines path = do
  reader   &lt;- openReader path
  reader.getLines</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here you have a shorter version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-haskell" data-lang="haskell">readLines' :: String -&gt; IO [String]
readLines' path = openReader path &gt;&gt;= _.getLines</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Here we were using the placeholder notation <code>_.XXX</code> to
avoid creating intermediate values.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>But bear in mind that if you give a wrong path the
function call will raise an error. Here is an example returning an
empty list in case the file doesn&#8217;t exists.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-haskell" data-lang="haskell">safeReadLines :: String -&gt; IO [String]
safeReadLines path = openReader path &gt;&gt;= _.getLines
    `catch` (\(e :: FileNotFoundException) -&gt; return [])</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing">Writing</h3>
<div class="paragraph">
<p>As opposed to <strong>openReader</strong> there is a <strong>openWriter</strong> to write to a
file. The <strong>openWriter</strong> and <strong>appendWriter</strong> functions return a
<strong>PrintWriter</strong> instance. Lets see how can we use them. In the first
example I&#8217;m setting the content of a file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-haskell" data-lang="haskell">writeStringToFile :: String -&gt; String -&gt; IO ()
writeStringToFile path line = do
    writer   &lt;- openWriter path <i class="conum" data-value="1"></i><b>(1)</b>
    writer.print line <i class="conum" data-value="2"></i><b>(2)</b>
    writer.flush <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Getting the <strong>PrintWriter</strong> instance</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Writing to file</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Flushing to reflect the changes</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
flushing is important when writing to a file.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>But most of the time we would like to append information to a
file. The following example does exactly that.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-haskell" data-lang="haskell">appendLine :: String -&gt; String -&gt; IO ()
appendLine path line = do
    writer   &lt;- appendWriter path <i class="conum" data-value="1"></i><b>(1)</b>
    writer.println line <i class="conum" data-value="2"></i><b>(2)</b>
    writer.flush <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Getting the <strong>PrintWriter</strong> instance</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Appending content to a file</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Flushing to reflect the changes</td>
</tr>
</table>
</div>
</div></yieldScaped></section>
                </div>
            </div><div id="sidebar">
                <div class="inner">
                    <!--Menu--><nav id="menu">
                        <header class="major">
                            <h2>Menu</h2>
                        </header><ul>
                            <li>
                                <a href="/index.html">Latests entries</a>
                            </li><li>
                                <a href="/archive.html">Archive</a>
                            </li><li>
                                <a href="/about.html">About</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div><script src="/js/jquery.min.js"></script>
            <script src="/js/browser.min.js"></script>
            <script src="/js/breakpoints.min.js"></script>
            <script src="/js/util.js"></script>
            <script src="/js/main.js"></script>
            <script src="/js/highlight.pack.js"></script>
            <script type="text/javascript">
                
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightBlock(block);
            });
        });
    
            </script>
        </div>
    </body>
</html>
